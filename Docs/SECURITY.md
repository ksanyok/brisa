# Модель безопасности Brisa

Brisa выполняет действия от имени пользователя, поэтому безопасность и контроль имеют первостепенное значение. Этот документ описывает подходы к минимизации рисков и механизмам подтверждения действий.

## Принципы безопасности

1. **Минимально необходимые привилегии.** Brisa запрашивает только те разрешения (TCC), которые необходимы для текущей операции: доступ к микрофону для распознавания голоса, к экрану для отображения Agent Space и к Accessibility для управления другими приложениями.
2. **Изолированная рабочая область.** Все действия агента выполняются на отдельном рабочем столе (Agent Space) и в отдельном профиле Chromium, чтобы не вмешиваться в рабочие окна пользователя.
3. **Планирование и контроль.** Перед выполнением задачи планировщик разбивает её на шаги. Каждому шагу присваивается категория риска (low, medium, high) с помощью `RiskPolicy`.
4. **Подтверждение действий.** В соответствии с категорией риска Brisa запрашивает подтверждение пользователя перед выполнением высокорисковых действий (отправка, публикация, покупка, удаление и др.).
5. **Прерываемость.** Пользователь может в любой момент поставить агента на паузу или полностью перехватить управление через Clone View.
6. **Журналирование.** Все события, намерения, шаги и артефакты записываются в базу данных журнала. Это позволяет восстановить ход операций и анализировать поведение агента.

## Категории риска

| Категория | Описание                                                          | Подтверждение |
|---------|-------------------------------------------------------------------|---------------|
| Low     | Локальные чтения, навигация, подготовка черновиков, скриншоты.    | Не требуется  |
| Medium  | Запись локальных файлов, заполнение форм, подготовка клик‑шагов. | Smart Ask: одно подтверждение на серию действий |
| High    | Отправка, публикация, покупка, удаление, массовые рассылки.       | Always Ask: обязательное подтверждение перед каждым действием |

Точные правила классификации описаны в `RiskPolicy` и могут быть настроены через настройки безопасности в приложении.

## Политика подтверждений

В настройках (`Settings → Safety`) можно выбрать режим:

- **Always Ask.** Все действия выше категории low требуют подтверждения.
- **Smart Ask.** Brisa группирует несколько связанных шагов и запрашивает одно подтверждение.
- **Trust List.** Пользователь может добавить определённые действия или сайты в белый список, чтобы выполнять их без подтверждений.

В MVP режим **Always Ask** включён по умолчанию.